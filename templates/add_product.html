{% extends "base.html" %}
{% block title %}Add Product - Inventory System{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
    <!-- Header with Gradient -->
    <div class="mb-8 text-center">
        <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl mb-4 shadow-lg">
            <i class="fas fa-plus text-white text-2xl"></i>
        </div>
        <h1 class="text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2">
            Add New Product
        </h1>
        <p class="text-gray-600 text-lg">Expand your inventory with amazing products</p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Main Form -->
        <div class="lg:col-span-2">
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100">
                <!-- Form Header -->
                <div class="bg-gradient-to-r from-blue-600 to-purple-600 px-8 py-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h2 class="text-2xl font-bold text-white">Product Information</h2>
                            <p class="text-blue-100">Fill in the details to add a new product</p>
                        </div>
                        <div class="w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center">
                            <i class="fas fa-box-open text-white text-xl"></i>
                        </div>
                    </div>
                </div>
                
                <form method="POST" action="{{ url_for('add_product') }}" class="p-8">
                    <div class="space-y-8">
                        <!-- Product Name -->
                        <div class="group">
                            <label for="name" class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                                <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3 group-focus-within:bg-blue-500 transition-colors">
                                    <i class="fas fa-tag text-blue-500 group-focus-within:text-white transition-colors"></i>
                                </div>
                                Product Name *
                            </label>
                            <input type="text" id="name" name="name" required
                                   class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all duration-300 placeholder-gray-400"
                                   placeholder="Enter an amazing product name...">
                        </div>

                        <!-- Category Section -->
                        <div class="group">
                            <label for="category" class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                                <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center mr-3 group-focus-within:bg-purple-500 transition-colors">
                                    <i class="fas fa-folder text-purple-500 group-focus-within:text-white transition-colors"></i>
                                </div>
                                Category *
                            </label>
                            <div class="relative">
                                <input type="text" id="category" name="category" required
                                       class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:ring-4 focus:ring-purple-100 transition-all duration-300 placeholder-gray-400"
                                       placeholder="Type or select a category"
                                       list="category-suggestions">
                                <datalist id="category-suggestions">
                                    {% for category in existing_categories %}
                                    <option value="{{ category }}">
                                    {% endfor %}
                                    <option value="Electronics">
                                    <option value="Clothing">
                                    <option value="Books">
                                    <option value="Home & Garden">
                                    <option value="Sports">
                                    <option value="Beauty">
                                    <option value="Food & Beverages">
                                    <option value="Health">
                                    <option value="Office Supplies">
                                    <option value="Pet Supplies">
                                    <option value="Automotive">
                                    <option value="Toys">
                                </datalist>
                            </div>
                        </div>

                        <!-- Price & Quantity Row -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Price -->
                            <div class="group">
                                <label for="price" class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                                    <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3 group-focus-within:bg-green-500 transition-colors">
                                        <i class="fas fa-dollar-sign text-green-500 group-focus-within:text-white transition-colors"></i>
                                    </div>
                                    Price ($) *
                                </label>
                                <div class="relative">
                                    <span class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500 font-medium">$</span>
                                    <input type="number" id="price" name="price" step="0.01" min="0" required
                                           class="w-full pl-10 pr-4 py-4 border-2 border-gray-200 rounded-xl focus:border-green-500 focus:ring-4 focus:ring-green-100 transition-all duration-300 placeholder-gray-400"
                                           placeholder="0.00">
                                </div>
                            </div>

                            <!-- Quantity -->
                            <div class="group">
                                <label for="quantity" class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                                    <div class="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center mr-3 group-focus-within:bg-orange-500 transition-colors">
                                        <i class="fas fa-cubes text-orange-500 group-focus-within:text-white transition-colors"></i>
                                    </div>
                                    Quantity *
                                </label>
                                <input type="number" id="quantity" name="quantity" min="0" required
                                       class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:border-orange-500 focus:ring-4 focus:ring-orange-100 transition-all duration-300 placeholder-gray-400"
                                       placeholder="0">
                            </div>
                        </div>

                        <!-- Description -->
                        <div class="group">
                            <label for="description" class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                                <div class="w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center mr-3 group-focus-within:bg-indigo-500 transition-colors">
                                    <i class="fas fa-align-left text-indigo-500 group-focus-within:text-white transition-colors"></i>
                                </div>
                                Description
                            </label>
                            <textarea id="description" name="description" rows="4"
                                      class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-100 transition-all duration-300 placeholder-gray-400 resize-none"
                                      placeholder="Describe your amazing product... (Optional)"></textarea>
                        </div>
                    </div>

                    <!-- Quick Select Categories -->
                    <div class="mt-8 p-6 bg-gradient-to-r from-gray-50 to-blue-50 rounded-2xl border border-gray-200">
                        <label class="block text-sm font-semibold text-gray-700 mb-4 flex items-center">
                            <div class="w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-bolt text-yellow-500"></i>
                            </div>
                            Quick Select Categories:
                        </label>
                        <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">
                            {% set quick_categories = [
                                {'name': 'Electronics', 'icon': 'laptop', 'color': 'blue'},
                                {'name': 'Clothing', 'icon': 'tshirt', 'color': 'green'},
                                {'name': 'Books', 'icon': 'book', 'color': 'purple'},
                                {'name': 'Home & Garden', 'icon': 'home', 'color': 'orange'},
                                {'name': 'Sports', 'icon': 'basketball-ball', 'color': 'red'},
                                {'name': 'Beauty', 'icon': 'spa', 'color': 'pink'},
                                {'name': 'Food & Beverages', 'icon': 'utensils', 'color': 'yellow'},
                                {'name': 'Health', 'icon': 'heartbeat', 'color': 'indigo'}
                            ] %}
                            {% for cat in quick_categories %}
                            <button type="button" onclick="setCategory('{{ cat.name }}')" 
                                    class="p-3 bg-white rounded-xl border-2 border-{{ cat.color }}-100 hover:border-{{ cat.color }}-300 hover:shadow-md transition-all duration-300 group text-left">
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-{{ cat.color }}-100 rounded-lg flex items-center justify-center mr-2 group-hover:bg-{{ cat.color }}-500 transition-colors">
                                        <i class="fas fa-{{ cat.icon }} text-{{ cat.color }}-500 group-hover:text-white transition-colors text-sm"></i>
                                    </div>
                                    <span class="text-sm font-medium text-gray-700">{{ cat.name }}</span>
                                </div>
                            </button>
                            {% endfor %}
                        </div>
                    </div>
                   
                    <!-- Form Actions -->
                    <div class="mt-8 flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0 pt-8 border-t border-gray-200">
                        <a href="{{ url_for('inventory') }}"
                           class="px-6 py-3 border-2 border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 hover:border-gray-400 transition-all duration-300 font-medium flex items-center group">
                            <i class="fas fa-arrow-left mr-2 group-hover:-translate-x-1 transition-transform"></i>
                            Back to Inventory
                        </a>

                        <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3">
                            <!-- Reset Database Button -->
                            <a href="{{ url_for('reset_db_route') }}"
                               class="px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl hover:from-red-600 hover:to-red-700 transition-all duration-300 font-medium shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 flex items-center justify-center group"
                               onclick="return confirm('⚠️ Are you sure you want to reset the database? This will delete ALL data and cannot be undone!')">
                                <i class="fas fa-database mr-2 group-hover:rotate-90 transition-transform"></i>
                                Reset Database
                            </a>

                            <button type="submit"
                                    class="px-8 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl hover:from-blue-600 hover:to-purple-700 transition-all duration-300 font-medium shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 flex items-center justify-center group">
                                <i class="fas fa-plus mr-2 group-hover:scale-110 transition-transform"></i>
                                Add Product
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- Sidebar - Tips & Preview -->
        <div class="space-y-6">
            <!-- Progress Card -->
            <div class="bg-white rounded-2xl shadow-xl p-6 border border-gray-100">
                <h3 class="font-bold text-gray-900 mb-4 flex items-center">
                    <i class="fas fa-tasks text-blue-500 mr-2"></i>
                    Setup Progress
                </h3>
                <div class="space-y-4">
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-600">Basic Info</span>
                        <div class="w-3 h-3 bg-green-400 rounded-full"></div>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-600">Pricing</span>
                        <div class="w-3 h-3 bg-yellow-400 rounded-full"></div>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-600">Inventory</span>
                        <div class="w-3 h-3 bg-yellow-400 rounded-full"></div>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-600">Categorization</span>
                        <div class="w-3 h-3 bg-yellow-400 rounded-full"></div>
                    </div>
                </div>
            </div>

            <!-- Tips Card -->
            <div class="bg-gradient-to-br from-orange-50 to-amber-50 rounded-2xl shadow-xl p-6 border border-orange-200">
                <h3 class="font-bold text-gray-900 mb-4 flex items-center">
                    <i class="fas fa-lightbulb text-orange-500 mr-2"></i>
                    Pro Tips
                </h3>
                <div class="space-y-3">
                    <div class="flex items-start">
                        <i class="fas fa-check-circle text-green-500 mt-1 mr-3 flex-shrink-0"></i>
                        <p class="text-sm text-gray-700">Use descriptive names that are easy to search</p>
                    </div>
                    <div class="flex items-start">
                        <i class="fas fa-check-circle text-green-500 mt-1 mr-3 flex-shrink-0"></i>
                        <p class="text-sm text-gray-700">Set realistic stock levels to avoid overselling</p>
                    </div>
                    <div class="flex items-start">
                        <i class="fas fa-check-circle text-green-500 mt-1 mr-3 flex-shrink-0"></i>
                        <p class="text-sm text-gray-700">Use consistent categories for better organization</p>
                    </div>
                    <div class="flex items-start">
                        <i class="fas fa-check-circle text-green-500 mt-1 mr-3 flex-shrink-0"></i>
                        <p class="text-sm text-gray-700">Add clear descriptions to help with product identification</p>
                    </div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl shadow-xl p-6 border border-blue-200">
                <h3 class="font-bold text-gray-900 mb-4 flex items-center">
                    <i class="fas fa-chart-line text-blue-500 mr-2"></i>
                    Inventory Stats
                </h3>
                <div class="space-y-3">
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">Total Products</span>
                        <span class="font-bold text-blue-600">{{ products|length }}</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">Categories</span>
                        <span class="font-bold text-green-600">{{ existing_categories|length }}</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-gray-600">In Stock</span>
                        <span class="font-bold text-green-600">{{ products|selectattr('quantity', 'gt', 0)|list|length }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Function to set category from quick select buttons
function setCategory(category) {
    const categoryInput = document.getElementById('category');
    categoryInput.value = category;
    categoryInput.focus();
    
    // Add visual feedback
    categoryInput.classList.add('ring-4', 'ring-purple-100');
    setTimeout(() => {
        categoryInput.classList.remove('ring-4', 'ring-purple-100');
    }, 1000);
}

// Auto-capitalize category first letter
document.getElementById('category').addEventListener('blur', function() {
    if (this.value.trim()) {
        this.value = this.value.trim().charAt(0).toUpperCase() + this.value.trim().slice(1);
    }
});

// Real-time form validation with visual feedback
const inputs = document.querySelectorAll('input[required], textarea');
inputs.forEach(input => {
    input.addEventListener('input', function() {
        if (this.value.trim()) {
            this.classList.add('border-green-400');
            this.classList.remove('border-red-400');
        } else {
            this.classList.remove('border-green-400');
        }
    });
    
    input.addEventListener('blur', function() {
        if (this.required && !this.value.trim()) {
            this.classList.add('border-red-400');
        }
    });
});

// Price formatting
document.getElementById('price').addEventListener('input', function(e) {
    let value = e.target.value.replace(/[^\d.]/g, '');
    let parts = value.split('.');
    if (parts.length > 2) {
        value = parts[0] + '.' + parts.slice(1).join('');
    }
    e.target.value = value;
});

// Add character counter for description
document.getElementById('description').addEventListener('input', function(e) {
    const charCount = e.target.value.length;
    let counter = document.getElementById('char-counter');
    if (!counter) {
        counter = document.createElement('div');
        counter.id = 'char-counter';
        counter.className = 'text-xs text-gray-500 mt-2 text-right';
        e.target.parentNode.appendChild(counter);
    }
    counter.textContent = `${charCount} characters`;
});

// Focus on name field when page loads
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('name').focus();
    
    // Add floating labels effect
    const floatLabels = document.querySelectorAll('input, textarea');
    floatLabels.forEach(input => {
        input.addEventListener('focus', function() {
            this.parentElement.classList.add('focused');
        });
        input.addEventListener('blur', function() {
            if (!this.value) {
                this.parentElement.classList.remove('focused');
            }
        });
    });
});

// Enhanced form submission with loading state
document.querySelector('form').addEventListener('submit', function(e) {
    const submitBtn = this.querySelector('button[type="submit"]');
    const originalText = submitBtn.innerHTML;
    
    // Add loading state
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Adding Product...';
    submitBtn.disabled = true;
    
    // Re-enable after 3 seconds (in case of error)
    setTimeout(() => {
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
    }, 3000);
});
</script>

<style>
/* Custom animations */
@keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-5px); }
}

.floating {
    animation: float 3s ease-in-out infinite;
}

/* Enhanced focus states */
input:focus, textarea:focus, select:focus {
    transform: translateY(-2px);
    transition: all 0.3s ease;
}

/* Gradient text animation */
.gradient-text {
    background: linear-gradient(45deg, #3B82F6, #8B5CF6, #EC4899);
    background-size: 200% 200%;
    animation: gradient 3s ease infinite;
}

@keyframes gradient {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* Hover effects */
.hover-lift:hover {
    transform: translateY(-3px);
    transition: all 0.3s ease;
}
</style>
{% endblock %}